---
title: "TreeBuilding"
author: "Vinny Chloros"
format: html
editor: visual
---

```{r setup}
library(ape)
library(phangorn)
#library(BiocManager)
#library(fastreeR)
#library(utils)
#library(stats)
#library(grid)
#library(BiocFileCache)
#BiocManager::install("ggtree")
library(ggtree)
library(ggplot2)

set.seed(17032025)
```

# Phangorn Tree

```{r}
felidae <- read.phyDat("FelidaeAligned.fas", format = "fasta")

fitGTR <- pml_bb(felidae, model="GTR+G(4)+I")
```

```{r}
plotBS(midpoint(fitGTR$tree), p = .5, type="p", digits=2, main="Ultrafast bootstrap")
```

```{r}
ggtree(fitGTR$tree, branch.length="none") +
  geom_tiplab(size = 3, color = "purple") +
  xlim(c(0, 50))
```

```{r}
bs <- bootstrap.pml(fitGTR, bs=100, optNni=TRUE,
    control = pml.control(trace = 0))

plotBS(midpoint(fitGTR$tree), bs, p = 50, type="p", main="Standard bootstrap")

tree_stdbs <- plotBS(fitGTR$tree, bs, type = "n")

#cnet <- consensusNet(bs, p=0.2)
#cnet$node.label <- prop.clades(cnet, bs)

#plot(cnet, show.edge.label=TRUE)

ggtree(tree_stdbs, branch.length="none") +
  geom_tiplab(size = 3, color = "purple") +
  xlim(c(0, 50))

ggtree(cnet) +
    xlim(c(0, 50))

```

```{r}
#| eval: false

ggtree(bs, branch.length = "none") + 
  facet_wrap( ~.id, scale="free") + 
  theme_tree2()
```

## fasttreeR Tree

```{r setup}
library(fastreeR)
library(utils)
library(ape)
library(stats)
library(grid)
library(BiocFileCache)
```

```{r}


fasDistance <- fasta2dist(felidae, kmer = 6)
```

